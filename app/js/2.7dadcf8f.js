(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"00d3":function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"blockly",staticStyle:{"min-height":"inherit"}},[o("div",{ref:"blockly",staticClass:"blockly-wrap"}),o("xml",{ref:"toolbox",staticStyle:{display:"none"}},[e._t("default")],2)],1)},a=[],i=(o("ddb0"),o("ded3")),s=o.n(i),l=o("54ca"),r=o.n(l),p=o("2f62"),_="/**\r\n * IMPORTANT NOTE\r\n * This project MUST be ES5 compliant as that is what the JS Interpreter uses\r\n */\r\n\r\n/**\r\n * Simple tests\r\n */\r\nhasNumber = /\\d/\r\n \r\n/**\r\n * Stores events being listened to\r\n * {eventName: [...callbacks]}\r\n */\r\n_events = {}\r\n\r\n/**\r\n * console.log helper to properly send data to main app w/o obfuscation\r\n */\r\nconsole = {\r\n  log: function (arguments) {\r\n    log(JSON.stringify(arguments))\r\n  }\r\n}\r\n\r\n/**\r\n * target.addEventListener subsitution\r\n * @param {String} eventName The eventName to store this callback under\r\n * @param {Array} args The list of arguments\r\n * @param {Function} callback The function to call when this event is triggered\r\n */\r\naddEventListener = function (eventName, args, callback) {\r\n  if (!_events[eventName]) {\r\n    _events[eventName] = []\r\n  }\r\n\r\n  _events[eventName].push({\r\n    args: args,\r\n    callback: callback\r\n  })\r\n}\r\n\r\n/**\r\n * Trigger an event\r\n * @param {String} eventName \r\n * @param {*} payload\r\n */\r\ntriggerEvent = function (eventName, payload) {\r\n  _events[eventName] && _events[eventName].forEach(function (event) {\r\n    event.callback({\r\n      args: event.args,\r\n      payload: JSON.parse(payload)\r\n    })\r\n  })\r\n}\r\n\r\n/**\r\n * Plays a note\r\n */\r\nplayNote = function (payload) {\r\n  _playNote(JSON.stringify(payload))\r\n}\r\n\r\n/**\r\n * Compre helper for working with \"is\", \"is not\", etc\r\n */\r\ncompare = function (a, compare, b) {\r\n  switch (compare) {\r\n    case 'is':\r\n      return a == b\r\n    case 'is not':\r\n      return a != b\r\n  }\r\n}\r\n\r\n/**\r\n * Checks if a string belongs to the \"is any\" family (\"all\", \"any\", etc)\r\n */\r\nisAny = function (str) {\r\n  var list = ['any', 'all']\r\n  var isValid = false\r\n\r\n  list.forEach(function (item) {\r\n    if (str === item) isValid = true\r\n  });\r\n\r\n  return isValid\r\n}\r\n\r\n/**\r\n * Checks if a given note matches a webmidi.name\r\n * - If no octave present, then matches the key in any octave\r\n */\r\nisNote = function (a, compare, b) {\r\n  switch (compare) {\r\n    case 'is':\r\n      if (hasNumber.test()) {\r\n        return a == b.name.concat(b.octave)\r\n      } else {\r\n        return a == b.name\r\n      }\r\n\r\n    case 'is not':\r\n      if (hasNumber.test()) {\r\n        return a != b.name.concat(b.octave)\r\n      } else {\r\n        return a != b.name\r\n      }\r\n  }\r\n}",u=o("c62b"),c=o.n(u),d=o("2ef0"),h={name:"Blockly",props:["options","blocks"],watch:{"workspace.code"(e){this.$store.commit("set",["workspace.interpreter",new window.Interpreter(_+"\n"+this.workspace.code,this.setupInterpreter)]),this.workspace.interpreter.run()}},computed:s()({},Object(p["b"])(["workspace","devices"])),data(){return{blockly:null,interpreter:null}},mounted(){let e=this.$props.options||{};e=Object(d["defaults"])(this.$props.options,{renderer:"zelos",sounds:!1,toolbox:this.$refs.toolbox,media:"media/",zoom:{controls:!0,pinch:!0,wheel:!0,startScale:.8},grid:{spacing:50,length:50,colour:"#9effff",snap:!0}}),this.blockly=r.a.inject(this.$refs.blockly,e),this.blockly.addChangeListener(this.onChange),this.addBlocks()},methods:{onChange(e){this.$emit("change",e)},setupInterpreter(e,t){e.setProperty(t,"log",e.createNativeFunction(e=>{console.log("ðŸ“¦ log: ",...JSON.parse(e))})),e.setProperty(t,"_playNote",e.createNativeFunction(e=>{let t=JSON.parse(e);"all"===t.device&&Object.keys(this.devices.outputs).forEach(e=>{const o=c.a.getOutputById(e);o.playNote(t.note,t.channel)})}))},addBlocks(){this.blocks.forEach(e=>{r.a.Blocks[e.title]={init:function(){this.jsonInit(JSON.parse(e.block_definition))}},r.a.JavaScript[e.title]=()=>"";const t=this.blockly.newBlock(e.title);t.initSvg(),t.render(),this.blockly.centerOnBlock(t.id),this.blockly.scroll(this.blockly.scrollX,this.blockly.scrollY)})}}},m=h,E=o("2877"),f=Object(E["a"])(m,n,a,!1,null,null,null);t["a"]=f.exports},"16b5":function(e,t,o){},"1dd6":function(e,t,o){"use strict";o("c975");var n=o("54ca"),a=o.n(n);a.a.Blocks["factory_base"]={init:function(){this.setColour("#2ca300"),this.appendDummyInput().appendField("name").appendField(new a.a.FieldTextInput("block_type"),"NAME"),this.appendStatementInput("INPUTS").setCheck("Input").appendField("inputs");var e=new a.a.FieldDropdown([["automatic inputs","AUTO"],["external inputs","EXT"],["inline inputs","INT"]]);this.appendDummyInput().appendField(e,"INLINE"),e=new a.a.FieldDropdown([["no connections","NONE"],["â† left output","LEFT"],["â†• top+bottom connections","BOTH"],["â†‘ top connection","TOP"],["â†“ bottom connection","BOTTOM"]],(function(e){this.sourceBlock_.updateShape_(e),this.sourceBlock_.spawnOutputShadow_(e)})),this.appendDummyInput().appendField(e,"CONNECTIONS"),this.appendValueInput("COLOUR").setCheck("Colour").appendField("colour"),this.setTooltip("Build a custom block by plugging\nfields, inputs and other blocks here."),this.setHelpUrl("https://developers.google.com/blockly/guides/create-custom-blocks/block-factory")},mutationToDom:function(){var e=a.a.utils.xml.createElement("mutation");return e.setAttribute("connections",this.getFieldValue("CONNECTIONS")),e},domToMutation:function(e){var t=e.getAttribute("connections");this.updateShape_(t)},spawnOutputShadow_:function(e){switch(e){case"LEFT":this.connectOutputShadow_("OUTPUTTYPE");break;case"TOP":this.connectOutputShadow_("TOPTYPE");break;case"BOTTOM":this.connectOutputShadow_("BOTTOMTYPE");break;case"BOTH":this.connectOutputShadow_("TOPTYPE"),this.connectOutputShadow_("BOTTOMTYPE");break}},connectOutputShadow_:function(e){var t=this.workspace.newBlock("type_null");t.setShadow(!0),t.outputConnection.connect(this.getInput(e).connection),t.initSvg(),t.render()},updateShape_:function(e){var t=this.getInput("OUTPUTTYPE"),o=this.getInput("TOPTYPE"),n=this.getInput("BOTTOMTYPE");"LEFT"==e?t||this.addTypeInput_("OUTPUTTYPE","output type"):t&&this.removeInput("OUTPUTTYPE"),"TOP"==e||"BOTH"==e?o||this.addTypeInput_("TOPTYPE","top type"):o&&this.removeInput("TOPTYPE"),"BOTTOM"==e||"BOTH"==e?n||this.addTypeInput_("BOTTOMTYPE","bottom type"):n&&this.removeInput("BOTTOMTYPE")},addTypeInput_:function(e,t){this.appendValueInput(e).setCheck("Type").appendField(t),this.moveInputBefore(e,"COLOUR")}};var i="fields %1 %2",s=[{type:"field_dropdown",name:"ALIGN",options:[["left","LEFT"],["right","RIGHT"],["centre","CENTRE"]]},{type:"input_statement",name:"FIELDS",check:"Field"}],l="type %1",r=[{type:"input_value",name:"TYPE",check:"Type",align:"RIGHT"}];function p(e){if(e.workspace){for(var t,o=e.getFieldValue("FIELDNAME").toLowerCase(),n=0,a=e.workspace.getAllBlocks(!1),i=0;t=a[i];i++){var s=t.getFieldValue("FIELDNAME");t.disabled||t.getInheritedDisabled()||!s||s.toLowerCase()!=o||n++}var l=n>1?"There are "+n+" field blocks\n with this name.":null;e.setWarningText(l)}}function _(e){if(e.workspace){for(var t,o=e.getFieldValue("INPUTNAME").toLowerCase(),n=0,a=e.workspace.getAllBlocks(!1),i=0;t=a[i];i++){var s=t.getFieldValue("INPUTNAME");t.disabled||t.getInheritedDisabled()||!s||s.toLowerCase()!=o||n++}var l=n>1?"There are "+n+" input blocks\n with this name.":null;e.setWarningText(l)}}a.a.Blocks["input_value"]={init:function(){this.jsonInit({message0:"value input %1 %2",args0:[{type:"field_input",name:"INPUTNAME",text:"NAME"},{type:"input_dummy"}],message1:i,args1:s,message2:l,args2:r,previousStatement:"Input",nextStatement:"Input",colour:"5D37F0",tooltip:"A value socket for horizontal connections.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=71"})},onchange:function(){_(this)}},a.a.Blocks["input_statement"]={init:function(){this.jsonInit({message0:"statement input %1 %2",args0:[{type:"field_input",name:"INPUTNAME",text:"NAME"},{type:"input_dummy"}],message1:i,args1:s,message2:l,args2:r,previousStatement:"Input",nextStatement:"Input",colour:"5D37F0",tooltip:"A statement socket for enclosed vertical stacks.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=246"})},onchange:function(){_(this)}},a.a.Blocks["input_dummy"]={init:function(){this.jsonInit({message0:"dummy input",message1:i,args1:s,previousStatement:"Input",nextStatement:"Input",colour:"5D37F0",tooltip:"For adding fields on a separate row with no connections. Alignment options (left, right, centre) apply only to multi-line fields.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=293"})}},a.a.Blocks["field_static"]={init:function(){this.setColour("2EC4B6"),this.appendDummyInput().appendField("text").appendField(new a.a.FieldTextInput(""),"TEXT"),this.setPreviousStatement(!0,"Field"),this.setNextStatement(!0,"Field"),this.setTooltip("Static text that serves as a label."),this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=88")}},a.a.Blocks["field_input"]={init:function(){this.setColour("2EC4B6"),this.appendDummyInput().appendField("text input").appendField(new a.a.FieldTextInput("default"),"TEXT").appendField(",").appendField(new a.a.FieldTextInput("NAME"),"FIELDNAME"),this.setPreviousStatement(!0,"Field"),this.setNextStatement(!0,"Field"),this.setTooltip("An input field for the user to enter text."),this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=319")},onchange:function(){p(this)}},a.a.Blocks["field_number"]={init:function(){this.setColour("2EC4B6"),this.appendDummyInput().appendField("numeric input").appendField(new a.a.FieldNumber(0),"VALUE").appendField(",").appendField(new a.a.FieldTextInput("NAME"),"FIELDNAME"),this.appendDummyInput().appendField("min").appendField(new a.a.FieldNumber(-1/0),"MIN").appendField("max").appendField(new a.a.FieldNumber(1/0),"MAX").appendField("precision").appendField(new a.a.FieldNumber(0,0),"PRECISION"),this.setPreviousStatement(!0,"Field"),this.setNextStatement(!0,"Field"),this.setTooltip("An input field for the user to enter a number."),this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=319")},onchange:function(){p(this)}},a.a.Blocks["field_angle"]={init:function(){this.setColour("2EC4B6"),this.appendDummyInput().appendField("angle input").appendField(new a.a.FieldAngle("90"),"ANGLE").appendField(",").appendField(new a.a.FieldTextInput("NAME"),"FIELDNAME"),this.setPreviousStatement(!0,"Field"),this.setNextStatement(!0,"Field"),this.setTooltip("An input field for the user to enter an angle."),this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=372")},onchange:function(){p(this)}},a.a.Blocks["field_dropdown"]={init:function(){this.appendDummyInput().appendField("dropdown").appendField(new a.a.FieldTextInput("NAME"),"FIELDNAME"),this.optionCount_=3,this.updateShape_(),this.setPreviousStatement(!0,"Field"),this.setNextStatement(!0,"Field"),this.setMutator(new a.a.Mutator(["field_dropdown_option"])),this.setColour("2EC4B6"),this.setTooltip("Dropdown menu with a list of options."),this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=386")},mutationToDom:function(e){var t=a.a.utils.xml.createElement("mutation");return t.setAttribute("options",this.optionCount_),t},domToMutation:function(e){this.optionCount_=parseInt(e.getAttribute("options"),10),this.updateShape_()},decompose:function(e){var t=e.newBlock("field_dropdown_container");t.initSvg();for(var o=t.getInput("STACK").connection,n=0;n<this.optionCount_;n++){var a=e.newBlock("field_dropdown_option");a.initSvg(),o.connect(a.previousConnection),o=a.nextConnection}return t},compose:function(e){var t=e.getInputTargetBlock("STACK"),o=[];while(t)o.push([t.userData_,t.cpuData_]),t=t.nextConnection&&t.nextConnection.targetBlock();this.optionCount_=o.length,this.updateShape_();for(var n=0;n<this.optionCount_;n++)this.setFieldValue(o[n][0]||"option","USER"+n),this.setFieldValue(o[n][1]||"OPTIONNAME","CPU"+n)},saveConnections:function(e){var t=e.getInputTargetBlock("STACK"),o=0;while(t)t.userData_=this.getFieldValue("USER"+o),t.cpuData_=this.getFieldValue("CPU"+o),o++,t=t.nextConnection&&t.nextConnection.targetBlock()},updateShape_:function(){for(var e=0;e<this.optionCount_;e++)this.getInput("OPTION"+e)||this.appendDummyInput("OPTION"+e).appendField(new a.a.FieldTextInput("option"),"USER"+e).appendField(",").appendField(new a.a.FieldTextInput("OPTIONNAME"),"CPU"+e);while(this.getInput("OPTION"+e))this.removeInput("OPTION"+e),e++},onchange:function(){this.workspace&&this.optionCount_<1?this.setWarningText("Drop down menu must\nhave at least one option."):p(this)}},a.a.Blocks["field_dropdown_container"]={init:function(){this.setColour("2EC4B6"),this.appendDummyInput().appendField("add options"),this.appendStatementInput("STACK"),this.setTooltip("Add, remove, or reorder options\nto reconfigure this dropdown menu."),this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=386"),this.contextMenu=!1}},a.a.Blocks["field_dropdown_option"]={init:function(){this.setColour("2EC4B6"),this.appendDummyInput().appendField("option"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip("Add a new option to the dropdown menu."),this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=386"),this.contextMenu=!1}},a.a.Blocks["field_checkbox"]={init:function(){this.setColour("2EC4B6"),this.appendDummyInput().appendField("checkbox").appendField(new a.a.FieldCheckbox("TRUE"),"CHECKED").appendField(",").appendField(new a.a.FieldTextInput("NAME"),"FIELDNAME"),this.setPreviousStatement(!0,"Field"),this.setNextStatement(!0,"Field"),this.setTooltip("Checkbox field."),this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=485")},onchange:function(){p(this)}},a.a.Blocks["field_colour"]={init:function(){this.setColour("2EC4B6"),this.appendDummyInput().appendField("colour").appendField(",").appendField(new a.a.FieldTextInput("NAME"),"FIELDNAME"),this.setPreviousStatement(!0,"Field"),this.setNextStatement(!0,"Field"),this.setTooltip("Colour input field."),this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=495")},onchange:function(){p(this)}},a.a.Blocks["field_variable"]={init:function(){this.setColour("2EC4B6"),this.appendDummyInput().appendField("variable").appendField(new a.a.FieldTextInput("item"),"TEXT").appendField(",").appendField(new a.a.FieldTextInput("NAME"),"FIELDNAME"),this.setPreviousStatement(!0,"Field"),this.setNextStatement(!0,"Field"),this.setTooltip("Dropdown menu for variable names."),this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=510")},onchange:function(){p(this)}},a.a.Blocks["field_image"]={init:function(){this.setColour("2EC4B6");var e="https://www.gstatic.com/codesite/ph/images/star_on.gif";this.appendDummyInput().appendField("image").appendField(new a.a.FieldTextInput(e),"SRC"),this.appendDummyInput().appendField("width").appendField(new a.a.FieldNumber("15",0,NaN,1),"WIDTH").appendField("height").appendField(new a.a.FieldNumber("15",0,NaN,1),"HEIGHT").appendField("alt text").appendField(new a.a.FieldTextInput("*"),"ALT"),this.setPreviousStatement(!0,"Field"),this.setNextStatement(!0,"Field"),this.setTooltip("Static image (JPEG, PNG, GIF, SVG, BMP).\nRetains aspect ratio regardless of height and width.\nAlt text is for when collapsed."),this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=567")}},a.a.Blocks["type_group"]={init:function(){this.typeCount_=2,this.updateShape_(),this.setOutput(!0,"Type"),this.setMutator(new a.a.Mutator(["type_group_item"])),this.setColour("ff628c"),this.setTooltip("Allows more than one type to be accepted."),this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=677")},mutationToDom:function(e){var t=a.a.utils.xml.createElement("mutation");return t.setAttribute("types",this.typeCount_),t},domToMutation:function(e){this.typeCount_=parseInt(e.getAttribute("types"),10),this.updateShape_();for(var t=0;t<this.typeCount_;t++)this.removeInput("TYPE"+t);for(t=0;t<this.typeCount_;t++){var o=this.appendValueInput("TYPE"+t).setCheck("Type");0==t&&o.appendField("any of")}},decompose:function(e){var t=e.newBlock("type_group_container");t.initSvg();for(var o=t.getInput("STACK").connection,n=0;n<this.typeCount_;n++){var a=e.newBlock("type_group_item");a.initSvg(),o.connect(a.previousConnection),o=a.nextConnection}return t},compose:function(e){var t=e.getInputTargetBlock("STACK"),o=[];while(t)o.push(t.valueConnection_),t=t.nextConnection&&t.nextConnection.targetBlock();for(var n=0;n<this.typeCount_;n++){var i=this.getInput("TYPE"+n).connection.targetConnection;i&&-1==o.indexOf(i)&&i.disconnect()}this.typeCount_=o.length,this.updateShape_();for(n=0;n<this.typeCount_;n++)a.a.Mutator.reconnect(o[n],this,"TYPE"+n)},saveConnections:function(e){var t=e.getInputTargetBlock("STACK"),o=0;while(t){var n=this.getInput("TYPE"+o);t.valueConnection_=n&&n.connection.targetConnection,o++,t=t.nextConnection&&t.nextConnection.targetBlock()}},updateShape_:function(){for(var e=0;e<this.typeCount_;e++)if(!this.getInput("TYPE"+e)){var t=this.appendValueInput("TYPE"+e);0==e&&t.appendField("any of")}while(this.getInput("TYPE"+e))this.removeInput("TYPE"+e),e++}},a.a.Blocks["type_group_container"]={init:function(){this.jsonInit({message0:"add types %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],colour:"ff628c",tooltip:"Add, or remove allowed type.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=677"})}},a.a.Blocks["type_group_item"]={init:function(){this.jsonInit({message0:"type",previousStatement:null,nextStatement:null,colour:"ff628c",tooltip:"Add a new allowed type.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=677"})}},a.a.Blocks["type_null"]={valueType:null,init:function(){this.jsonInit({message0:"any",output:"Type",colour:"ff628c",tooltip:"Any type is allowed.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=602"})}},a.a.Blocks["type_boolean"]={valueType:"Boolean",init:function(){this.jsonInit({message0:"Boolean",output:"Type",colour:"ff628c",tooltip:"Booleans (true/false) are allowed.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=602"})}},a.a.Blocks["type_number"]={valueType:"Number",init:function(){this.jsonInit({message0:"Number",output:"Type",colour:"ff628c",tooltip:"Numbers (int/float) are allowed.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=602"})}},a.a.Blocks["type_string"]={valueType:"String",init:function(){this.jsonInit({message0:"String",output:"Type",colour:"ff628c",tooltip:"Strings (text) are allowed.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=602"})}},a.a.Blocks["type_list"]={valueType:"Array",init:function(){this.jsonInit({message0:"Array",output:"Type",colour:"ff628c",tooltip:"Arrays (lists) are allowed.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=602"})}},a.a.Blocks["type_other"]={init:function(){this.jsonInit({message0:"other %1",args0:[{type:"field_input",name:"TYPE",text:""}],output:"Type",colour:"ff628c",tooltip:"Custom type to allow.",helpUrl:"https://www.youtube.com/watch?v=s2_xaEvcVI0#t=702"})}},a.a.Blocks["colour_hue"]={init:function(){this.appendDummyInput().appendField("hue:").appendField(new a.a.FieldAngle("0",this.validator),"HUE"),this.setOutput(!0,"Colour"),this.setTooltip("Paint the block with this colour."),this.setHelpUrl("https://www.youtube.com/watch?v=s2_xaEvcVI0#t=55")},validator:function(e){var t=parseInt(e,10);isNaN(t)||this.sourceBlock_.setColour(t)},mutationToDom:function(e){var t=a.a.utils.xml.createElement("mutation");return t.setAttribute("colour",this.getColour()),t},domToMutation:function(e){this.setColour(e.getAttribute("colour"))}}},"671e":function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("c975"),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("a434"),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("5319"),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("498a"),core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_string_trim__WEBPACK_IMPORTED_MODULE_3__),C_projects_midiblocks_midiblocks_node_modules_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("ded3"),C_projects_midiblocks_midiblocks_node_modules_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(C_projects_midiblocks_midiblocks_node_modules_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_4__),_assets_blocks_foundry__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("1dd6"),_components_Workspace__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("00d3"),_components_CodeEditor__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("864f"),blockly__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("54ca"),blockly__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_8__),store__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("8ded"),store__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(store__WEBPACK_IMPORTED_MODULE_9__),lodash__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("2ef0"),lodash__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_10__);const UNNAMED="unnamed";let oldDir=null;__webpack_exports__["a"]={name:"PageCodeHome",components:{Workspace:_components_Workspace__WEBPACK_IMPORTED_MODULE_6__["a"],CodeEditor:_components_CodeEditor__WEBPACK_IMPORTED_MODULE_7__["a"]},watch:{splitter:Object(lodash__WEBPACK_IMPORTED_MODULE_10__["throttle"])((function(){store__WEBPACK_IMPORTED_MODULE_9___default.a.set("splitter",this.splitter),setTimeout(()=>{window.dispatchEvent(new Event("resize"))})}),50,{leading:!0,trailing:!0})},data(){const e=store__WEBPACK_IMPORTED_MODULE_9___default.a.get("currentFoundry",{});return{workspace:{blockly:null,hasLoaded:!1},code:e.code,splitter:store__WEBPACK_IMPORTED_MODULE_9___default.a.get("splitter")||window.innerWidth/3,previewWorkspace:null,options:{isFactory:!0,collapse:!1}}},mounted(){Object(lodash__WEBPACK_IMPORTED_MODULE_10__["set"])(window,"app.$foundry",this),this.workspace.blockly=this.$refs.workspace.blockly;const e=store__WEBPACK_IMPORTED_MODULE_9___default.a.get("currentFoundry",{});e.workspace?blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Xml.domToWorkspace(blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Xml.textToDom(e.workspace),this.workspace.blockly):blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Xml.domToWorkspace(blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Xml.textToDom('<xml xmlns="https://developers.google.com/blockly/xml"><block type="factory_base" deletable="false" movable="false"></block></xml>'),this.$refs.workspace.blockly),this.workspace.blockly.addChangeListener(blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Events.disableOrphans)},methods:{autosave(){store__WEBPACK_IMPORTED_MODULE_9___default.a.set("currentFoundry",{code:this.code,workspace:blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Xml.domToText(blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Xml.workspaceToDom(this.workspace.blockly))})},onCodeChange(e){this.code=e,this.autosave()},workspaceEventHandler(e){switch(e.type){case blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Events.FINISHED_LOADING:this.workspace.hasLoaded=!0;break;case blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Events.BLOCK_CREATE:case blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Events.BLOCK_DELETE:case blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Events.BLOCK_CHANGE:case blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Events.BLOCK_MOVE:case blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Events.VAR_CREATE:case blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Events.VAR_DELETE:case blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Events.VAR_RENAME:this.onWorkspaceChange(),this.workspace.hasLoaded&&this.autosave();break}},onWorkspaceChange(){const e=this.getRootBlock();if(!e)return;let t=e.getFieldValue("NAME").trim().toLowerCase();t||(t=""),t=t.replace(/\W/g,"_").replace(/^(\d)/,"_\\1"),this.injectCode(this.formatJson(t,e),"languagePre"),this.updatePreview()},getRootBlock(){const e=this.workspace.blockly.getTopBlocks(!1);for(var t,o=0;t=e[o];o++)if("factory_base"==t.type)return t},formatJson(e,t){var o={};o.type=e;var n=[],a=[],i=t.getInputTargetBlock("INPUTS"),s=null;while(i){if(!i.disabled&&!i.getInheritedDisabled()){for(var l=this.getFieldsJson(i.getInputTargetBlock("FIELDS")),r=0;r<l.length;r++)"string"==typeof l[r]?n.push(l[r].replace(/%/g,"%%")):(a.push(l[r]),n.push("%"+a.length));var p={type:i.type};"input_dummy"!=i.type&&(p.name=i.getFieldValue("INPUTNAME"));var _=JSON.parse(this.getOptTypesFrom(i,"TYPE")||"null");_&&(p.check=_);var u=i.getFieldValue("ALIGN");"LEFT"!=u&&(p.align=u),a.push(p),n.push("%"+a.length),s=i}i=i.nextConnection&&i.nextConnection.targetBlock()}if(s&&"input_dummy"==s.type){l=s.getInputTargetBlock("FIELDS");if(l&&""!=this.getFieldsJson(l).join("").trim()){u=s.getFieldValue("ALIGN");"LEFT"!=u&&(o.lastDummyAlign0=u),a.pop(),n.pop()}}switch(o.message0=n.join(" "),a.length&&(o.args0=a),"EXT"==t.getFieldValue("INLINE")?o.inputsInline=!1:"INT"==t.getFieldValue("INLINE")&&(o.inputsInline=!0),t.getFieldValue("CONNECTIONS")){case"LEFT":o.output=JSON.parse(this.getOptTypesFrom(t,"OUTPUTTYPE")||"null");break;case"BOTH":o.previousStatement=JSON.parse(this.getOptTypesFrom(t,"TOPTYPE")||"null"),o.nextStatement=JSON.parse(this.getOptTypesFrom(t,"BOTTOMTYPE")||"null");break;case"TOP":o.previousStatement=JSON.parse(this.getOptTypesFrom(t,"TOPTYPE")||"null");break;case"BOTTOM":o.nextStatement=JSON.parse(this.getOptTypesFrom(t,"BOTTOMTYPE")||"null");break}var c=t.getInputTargetBlock("COLOUR");if(c&&!c.disabled){var d=parseInt(c.getFieldValue("HUE"),10);o.colour=d}return o.tooltip="",o.helpUrl="http://www.example.com/",JSON.stringify(o,null,"  ")},injectCode(e,t){var o=document.getElementById(t);o.textContent=e},updatePreview(){var newDir=document.getElementById("direction").value;this.previewWorkspace&&this.previewWorkspace.dispose();var rtl="rtl"==newDir;const options=Object.assign({},this.options);options.zoom.controls=!1,options.trashcan=!1,options.toolbox=null,this.previewWorkspace=blockly__WEBPACK_IMPORTED_MODULE_8___default.a.inject("preview",C_projects_midiblocks_midiblocks_node_modules_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_4___default()({media:"media/"},options)),this.previewWorkspace.clear();var format=document.getElementById("format").value;if("Manual"==format){var code=document.getElementById("languageTA").value;try{JSON.parse(code),format="JSON"}catch(e){format="JavaScript"}}else var code=document.getElementById("languagePre").textContent;if(code.trim()){var backupBlocks=blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Blocks;try{for(var prop in blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Blocks={},backupBlocks)blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Blocks[prop]=backupBlocks[prop];if("JSON"==format){var json=JSON.parse(code);blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Blocks[json.type||UNNAMED]={init:function(){this.jsonInit(json)}}}else{if("JavaScript"!=format)throw"Unknown format: "+format;eval(code)}var blockType=null;for(var type in blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Blocks)if("function"==typeof blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Blocks[type].init&&blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Blocks[type]!=backupBlocks[type]){blockType=type;break}if(!blockType)return;var previewBlock=this.previewWorkspace.newBlock(blockType);previewBlock.initSvg(),previewBlock.render(),previewBlock.setMovable(!1),previewBlock.setDeletable(!1),previewBlock.moveBy(15,10),this.previewWorkspace.clearUndo(),this.updateGenerator(previewBlock)}finally{blockly__WEBPACK_IMPORTED_MODULE_8___default.a.Blocks=backupBlocks}}},updateGenerator(e){function t(e,t){return t=t.toLowerCase().replace(/\W/g,"_"),"  var "+e+"_"+t}var o=document.getElementById("language").value,n=[];n.push("Blockly."+o+"['"+e.type+"'] = function(block) {");for(var a,i=0;a=e.inputList[i];i++){for(var s,l=0;s=a.fieldRow[l];l++){var r=s.name;r&&(s instanceof blockly__WEBPACK_IMPORTED_MODULE_8___default.a.FieldVariable?n.push(t("variable",r)+" = Blockly."+o+".variableDB_.getName(block.getFieldValue('"+r+"'), Blockly.Variables.NAME_TYPE);"):s instanceof blockly__WEBPACK_IMPORTED_MODULE_8___default.a.FieldAngle?n.push(t("angle",r)+" = block.getFieldValue('"+r+"');"):s instanceof blockly__WEBPACK_IMPORTED_MODULE_8___default.a.FieldColour?n.push(t("colour",r)+" = block.getFieldValue('"+r+"');"):s instanceof blockly__WEBPACK_IMPORTED_MODULE_8___default.a.FieldCheckbox?n.push(t("checkbox",r)+" = block.getFieldValue('"+r+"') == 'TRUE';"):s instanceof blockly__WEBPACK_IMPORTED_MODULE_8___default.a.FieldDropdown?n.push(t("dropdown",r)+" = block.getFieldValue('"+r+"');"):s instanceof blockly__WEBPACK_IMPORTED_MODULE_8___default.a.FieldNumber?n.push(t("number",r)+" = block.getFieldValue('"+r+"');"):s instanceof blockly__WEBPACK_IMPORTED_MODULE_8___default.a.FieldTextInput&&n.push(t("text",r)+" = block.getFieldValue('"+r+"');"))}r=a.name;r&&(a.type==blockly__WEBPACK_IMPORTED_MODULE_8___default.a.INPUT_VALUE?n.push(t("value",r)+" = Blockly."+o+".valueToCode(block, '"+r+"', Blockly."+o+".ORDER_ATOMIC);"):a.type==blockly__WEBPACK_IMPORTED_MODULE_8___default.a.NEXT_STATEMENT&&n.push(t("statements",r)+" = Blockly."+o+".statementToCode(block, '"+r+"');"))}var p={JavaScript:";",Python:"",PHP:";",Dart:";"};n.push("  // TODO: Assemble "+o+" into code variable."),e.outputConnection?(n.push("  var code = '...';"),n.push("  // TODO: Change ORDER_NONE to the correct strength."),n.push("  return [code, Blockly."+o+".ORDER_NONE];")):(n.push("  var code = '..."+(p[o]||"")+"\\n';"),n.push("  return code;")),n.push("};"),this.injectCode(n.join("\n"),"generatorPre")},getFieldsJson(e){var t=[];while(e){if(!e.disabled&&!e.getInheritedDisabled())switch(e.type){case"field_static":t.push(e.getFieldValue("TEXT"));break;case"field_input":t.push({type:e.type,name:e.getFieldValue("FIELDNAME"),text:e.getFieldValue("TEXT")});break;case"field_number":var o={type:e.type,name:e.getFieldValue("FIELDNAME"),value:Number(e.getFieldValue("VALUE"))},n=Number(e.getFieldValue("MIN"));n>-1/0&&(o.min=n);var a=Number(e.getFieldValue("MAX"));a<1/0&&(o.max=a);var i=Number(e.getFieldValue("PRECISION"));i&&(o.precision=i),t.push(o);break;case"field_angle":t.push({type:e.type,name:e.getFieldValue("FIELDNAME"),angle:Number(e.getFieldValue("ANGLE"))});break;case"field_checkbox":t.push({type:e.type,name:e.getFieldValue("FIELDNAME"),checked:"TRUE"==e.getFieldValue("CHECKED")});break;case"field_colour":t.push({type:e.type,name:e.getFieldValue("FIELDNAME"),colour:e.getFieldValue("COLOUR")});break;case"field_variable":t.push({type:e.type,name:e.getFieldValue("FIELDNAME"),variable:e.getFieldValue("TEXT")||null});break;case"field_dropdown":for(var s=[],l=0;l<e.optionCount_;l++)s[l]=[e.getFieldValue("USER"+l),e.getFieldValue("CPU"+l)];s.length&&t.push({type:e.type,name:e.getFieldValue("FIELDNAME"),options:s});break;case"field_image":t.push({type:e.type,src:e.getFieldValue("SRC"),width:Number(e.getFieldValue("WIDTH")),height:Number(e.getFieldValue("HEIGHT")),alt:e.getFieldValue("ALT")});break}e=e.nextConnection&&e.nextConnection.targetBlock()}return t},getOptTypesFrom(e,t){var o=this.getTypesFrom(e,t);return 0==o.length?void 0:-1!=o.indexOf("null")?"null":1==o.length?o[0]:"["+o.join(", ")+"]"},getTypesFrom(e,t){var o,n=e.getInputTargetBlock(t);if(!n||n.disabled)o=[];else if("type_other"==n.type)o=[this.escapeString(n.getFieldValue("TYPE"))];else if("type_group"==n.type){o=[];for(var a=0;a<n.typeCount_;a++)o=o.concat(this.getTypesFrom(n,"TYPE"+a));for(var i=Object.create(null),s=o.length-1;s>=0;s--)i[o[s]]&&o.splice(s,1),i[o[s]]=!0}else o=[this.escapeString(n.valueType)];return o},escapeString(e){return JSON.stringify(e)}}}},"6d20":function(e,t,o){"use strict";var n=o("16b5"),a=o.n(n);a.a},"864f":function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("MonacoEditor",{ref:"editor",attrs:{language:"javascript",options:e.options,theme:"shadesofpurple"},on:{editorDidMount:e.editorDidMount},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})},a=[],i=o("059c"),s={name:"PageCode",components:{MonacoEditor:i["a"]},props:["value"],watch:{code(e){this.$emit("onCodeChange",e)}},data(){return{code:this.$props.value,options:{theme:"shadesofpurple",automaticLayout:!0,minimap:{enabled:!1}}}},methods:{editorDidMount(e){const t=this.$refs.editor.monaco;t.editor.defineTheme("shadesofpurple",{base:"vs-dark",inherit:!0,rules:[{token:"",foreground:"9EFFFF",background:"9EFFFF"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"ff0000"},{token:"variable.parameter",foreground:"9EFFFF"},{token:"comment",foreground:"B362FF"},{token:"number",foreground:"FF628C"},{token:"number.hex",foreground:"FF628C"},{token:"regexp",foreground:"FB94FF"},{token:"type",foreground:"9EFFFF"},{token:"delimiter",foreground:"ffffff"},{token:"attribute.name",foreground:"ff0000"},{token:"attribute.value",foreground:"ff0000"},{token:"string",foreground:"A5FF90"},{token:"keyword",foreground:"FF9D00"}],colors:{"editorIndentGuide.background":"#A599E90F","editorIndentGuide.activeBackground":"#A599E942","editor.background":"#2d2b55","editor.foreground":"#ffffff","editor.selectionBackground":"#7448af","editor.lineHighlightBackground":"#1f1f41","editorCursor.foreground":"#fad000","editorWhitespace.foreground":"red"}}),t.editor.setTheme("shadesofpurple")}}},l=s,r=o("2877"),p=Object(r["a"])(l,n,a,!1,null,null,null);t["a"]=p.exports},d12e:function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-page",{staticStyle:{height:"1px"}},[o("q-splitter",{staticClass:"full-height q-pt-appbar",attrs:{id:"foundry-splitter",unit:"px",reverse:""},scopedSlots:e._u([{key:"after",fn:function(){return[o("div",{staticClass:"flex column"},[o("div",{attrs:{id:"preview"}}),o("CodeEditor",{staticStyle:{flex:"2"},attrs:{value:e.code},on:{onCodeChange:e.onCodeChange}})],1)]},proxy:!0},{key:"before",fn:function(){return[o("Workspace",{ref:"workspace",staticClass:"fill",attrs:{blocks:[],options:e.options},on:{change:e.workspaceEventHandler}},[o("category",{attrs:{name:"Input"}},[o("block",{attrs:{type:"input_value"}},[o("value",{attrs:{name:"TYPE"}},[o("shadow",{attrs:{type:"type_null"}})])],1),o("block",{attrs:{type:"input_statement"}},[o("value",{attrs:{name:"TYPE"}},[o("shadow",{attrs:{type:"type_null"}})])],1),o("block",{attrs:{type:"input_dummy"}})],1),o("category",{attrs:{name:"Field"}},[o("block",{attrs:{type:"field_static"}}),o("block",{attrs:{type:"field_input"}}),o("block",{attrs:{type:"field_number"}}),o("block",{attrs:{type:"field_angle"}}),o("block",{attrs:{type:"field_dropdown"}}),o("block",{attrs:{type:"field_checkbox"}}),o("block",{attrs:{type:"field_colour"}}),o("block",{attrs:{type:"field_variable"}}),o("block",{attrs:{type:"field_image"}})],1),o("category",{attrs:{name:"Type"}},[o("block",{attrs:{type:"type_group"}}),o("block",{attrs:{type:"type_null"}}),o("block",{attrs:{type:"type_boolean"}}),o("block",{attrs:{type:"type_number"}}),o("block",{attrs:{type:"type_string"}}),o("block",{attrs:{type:"type_list"}}),o("block",{attrs:{type:"type_other"}})],1),o("category",{attrs:{name:"Colour"}},[o("block",{attrs:{type:"colour_hue"}},[o("mutation",{attrs:{colour:"20"}}),o("field",{attrs:{name:"HUE"}},[e._v("20")])],1),o("block",{attrs:{type:"colour_hue"}},[o("mutation",{attrs:{colour:"65"}}),o("field",{attrs:{name:"HUE"}},[e._v("65")])],1),o("block",{attrs:{type:"colour_hue"}},[o("mutation",{attrs:{colour:"120"}}),o("field",{attrs:{name:"HUE"}},[e._v("120")])],1),o("block",{attrs:{type:"colour_hue"}},[o("mutation",{attrs:{colour:"160"}}),o("field",{attrs:{name:"HUE"}},[e._v("160")])],1),o("block",{attrs:{type:"colour_hue"}},[o("mutation",{attrs:{colour:"210"}}),o("field",{attrs:{name:"HUE"}},[e._v("210")])],1),o("block",{attrs:{type:"colour_hue"}},[o("mutation",{attrs:{colour:"230"}}),o("field",{attrs:{name:"HUE"}},[e._v("230")])],1),o("block",{attrs:{type:"colour_hue"}},[o("mutation",{attrs:{colour:"260"}}),o("field",{attrs:{name:"HUE"}},[e._v("260")])],1),o("block",{attrs:{type:"colour_hue"}},[o("mutation",{attrs:{colour:"290"}}),o("field",{attrs:{name:"HUE"}},[e._v("290")])],1),o("block",{attrs:{type:"colour_hue"}},[o("mutation",{attrs:{colour:"330"}}),o("field",{attrs:{name:"HUE"}},[e._v("330")])],1)],1)],1)]},proxy:!0}]),model:{value:e.splitter,callback:function(t){e.splitter=t},expression:"splitter"}}),o("div",{staticClass:"hidden"},[o("select",{attrs:{id:"direction"}},[o("option",{attrs:{value:"ltr"}},[e._v("LTR")]),o("option",{attrs:{value:"rtl"}},[e._v("RTL")])]),o("button",{attrs:{id:"linkButton"}}),o("button",{attrs:{id:"helpButton"}},[o("span",[e._v("Help")])]),o("select",{attrs:{id:"format"}},[o("option",{attrs:{value:"JSON"}},[e._v("JSON")]),o("option",{attrs:{value:"JavaScript"}},[e._v("JavaScript")]),o("option",{attrs:{value:"Manual"}},[e._v("Manual editâ€¦")])]),o("pre",{staticClass:"prettyprint lang-js",attrs:{id:"languagePre"}}),o("textarea",{attrs:{id:"languageTA"}}),o("select",{attrs:{id:"language"}},[o("option",{attrs:{value:"JavaScript"}},[e._v("JavaScript")]),o("option",{attrs:{value:"Python"}},[e._v("Python")]),o("option",{attrs:{value:"PHP"}},[e._v("PHP")]),o("option",{attrs:{value:"Lua"}},[e._v("Lua")]),o("option",{attrs:{value:"Dart"}},[e._v("Dart")])]),o("pre",{attrs:{id:"generatorPre"}})])],1)},a=[],i=o("671e"),s=i["a"],l=(o("6d20"),o("2877")),r=o("9989"),p=o("8562"),_=o("eebe"),u=o.n(_),c=Object(l["a"])(s,n,a,!1,null,"d7bd7dcc",null);t["default"]=c.exports;u()(c,"components",{QPage:r["a"],QSplitter:p["a"]})}}]);